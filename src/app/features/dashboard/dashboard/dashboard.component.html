<div class="dashboard-container">
  <!-- Welcome Header -->
  @if (currentUser$ | async; as user) {
    <div class="welcome-section">
      <h1 class="welcome-title">
        Welcome back, Dr. {{ user.firstName }} {{ user.lastName }}!
      </h1>
      <p class="welcome-subtitle">Here's what's happening in your practice today</p>
    </div>
  }

  <!-- Dashboard Stats -->
  <div class="stats-grid">
    <mat-card class="stat-card patients-card">
      <mat-card-content>
        <div class="stat-content">
          <div class="stat-icon">
            <mat-icon>people</mat-icon>
          </div>
          <div class="stat-info">
            <div class="stat-number">{{ dashboardStats.totalPatients }}</div>
            <div class="stat-label">Total Patients</div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card appointments-card">
      <mat-card-content>
        <div class="stat-content">
          <div class="stat-icon">
            <mat-icon>event</mat-icon>
          </div>
          <div class="stat-info">
            <div class="stat-number">{{ dashboardStats.todayAppointments }}</div>
            <div class="stat-label">Today's Appointments</div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card tasks-card">
      <mat-card-content>
        <div class="stat-content">
          <div class="stat-icon">
            <mat-icon>assignment</mat-icon>
          </div>
          <div class="stat-info">
            <div class="stat-number">{{ dashboardStats.pendingTasks }}</div>
            <div class="stat-label">Pending Tasks</div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card messages-card">
      <mat-card-content>
        <div class="stat-content">
          <div class="stat-icon">
            <mat-icon>message</mat-icon>
          </div>
          <div class="stat-info">
            <div class="stat-number">{{ dashboardStats.messagesUnread }}</div>
            <div class="stat-label">Unread Messages</div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Quick Actions and Recent Activity -->
  <div class="dashboard-content">
    <!-- Quick Actions -->
    <mat-card class="quick-actions-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>flash_on</mat-icon>
          Quick Actions
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="quick-actions-grid">
          @for (action of quickActions; track action.route) {
            <button mat-raised-button [color]="action.color" class="quick-action-btn" 
                    (click)="onQuickAction(action)">
              <mat-icon>{{ action.icon }}</mat-icon>
              <span>{{ action.label }}</span>
            </button>
          }
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Recent Activity -->
    <mat-card class="recent-activity-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>history</mat-icon>
          Recent Activity
        </mat-card-title>
        <mat-card-subtitle>Latest updates from your practice</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <mat-list class="activity-list">
          @for (activity of recentActivities; track activity.id) {
            <mat-list-item class="activity-item">
              <div matListItemIcon class="activity-icon" [class]="'activity-icon-' + getActivityColor(activity.type)">
                <mat-icon>{{ getActivityIcon(activity.type) }}</mat-icon>
              </div>
              <div matListItemTitle class="activity-title">{{ activity.title }}</div>
              <div matListItemLine class="activity-description">{{ activity.description }}</div>
              <div matListItemMeta class="activity-time">{{ getTimeAgo(activity.timestamp) }}</div>
            </mat-list-item>
            @if (!$last) {
              <mat-divider></mat-divider>
            }
          }
        </mat-list>
        <div class="view-all-activity">
          <button mat-button color="primary">View All Activity</button>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Today's Schedule Preview -->
  <mat-card class="schedule-preview-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>today</mat-icon>
        Today's Schedule
      </mat-card-title>
      <mat-card-subtitle>{{ dashboardStats.todayAppointments }} appointments scheduled</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
      <div class="schedule-preview">
        <div class="appointment-slot">
          <div class="appointment-time">09:00 AM</div>
          <div class="appointment-patient">Sarah Johnson - Routine Checkup</div>
          <mat-chip class="appointment-status confirmed">Confirmed</mat-chip>
        </div>
        <div class="appointment-slot">
          <div class="appointment-time">10:30 AM</div>
          <div class="appointment-patient">Mike Davis - Follow-up</div>
          <mat-chip class="appointment-status pending">Pending</mat-chip>
        </div>
        <div class="appointment-slot">
          <div class="appointment-time">02:00 PM</div>
          <div class="appointment-patient">Emily Brown - Consultation</div>
          <mat-chip class="appointment-status confirmed">Confirmed</mat-chip>
        </div>
      </div>
      <div class="view-full-schedule">
        <button mat-raised-button color="primary" routerLink="/appointments">
          View Full Schedule
        </button>
      </div>
    </mat-card-content>
  </mat-card>
</div>
